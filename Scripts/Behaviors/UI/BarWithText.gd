extends ProgressBar

@export var label_path: String
@export var text_format = "{value}/{max}"
@export var bar_color: Color
@export var text_color: Color
@export var update_color_every_frame = false

var label : Label

func _ready() -> void:
	label = get_node_or_null(label_path)
	# ??????????????????????????????????????????????????
	var fill = get_theme_stylebox("fill")
	fill.set_bg_color(bar_color)
	if label != null:
		label.set("theme_override_colors/font_color",text_color)

func _process(_delta):
	if label != null:
		label.text = text_format.format({"value": value, "max": max_value})
	if update_color_every_frame:
		# ????? ????????????????? ??????? ?? ? ? ? ?????????? ?????????
		var fill = get_theme_stylebox("fill")
		fill.set_bg_color(bar_color)
		if label != null:
			label.set("theme_override_colors/font_color",text_color)
